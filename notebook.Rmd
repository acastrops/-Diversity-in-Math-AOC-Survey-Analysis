---
title: Does the gender and ethnicity of New College students influence their experience
  with math classes?
author: "Adriana Souza, Lydia LaSeur, Roger Filmyer"
date: "November 12th, 2017"
bibliography: citations.bibtex
output:
  html_notebook:
    highlight: tango
    mathjax: null
    number_sections: yes
    theme: spacelab
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
# Loading packages we will be using
library(survey)
library(srvyr)
library(psych)
library(shiny)
library(plyr)
library(dplyr)
library(ggplot2)
library(tibble)
library(reshape2)
library(tidyr)
library(stringi)
library(likert)

## Libraries for OLR (Ordinal Logistic Regression)
library(foreign)
library(MASS)
library(Hmisc)
```

\  
\  

# Overview and motivation

This is a report created for Professor Chris Kottke's survey that was distributed during the Fall semester in 2017 at New College of Florida. The goal of the survey was to get more information about the students' experience in order to address the lack of gender diversity in the math AOC. Dr. Kottke wanted to gauge the general interest in mathematics and to measure things such as:

(1) Belonging uncertainty
(2) Confidence levels
(3) Stereotype threat

The descriptive statistics and tests will test to see if the responses to each question gauging each of those items varies depending on the respondent's gender, ethnicity, chosen AOC, and year. 

\  

## Backgroud information

The population consists of New College students exclusively, given that only respondents with an *\@ncf.edu* email address were allowed to reply: 

+ New College has 861 students (as of Fall 2016) and the survey had a total of 264 responses which are all complete.

+ Responders were 60% female, 28.3% male, and 11.7% non-binary.

+ The data was de-identified for the purpose of this study so no IRB approval was required. 

\  

## Data


Likert-type responses were chosen due to being a popular psychometric item scoring scheme when trying to quantify people’s opinions on different issues. The survey had a total of 26 questions which can be found in the appendix. The response items were all 5-level and ranged from "Strongly Disagree" to "Strongly Agree" as well as "Well below average" and "Well above average" depending on the question. Each question has corresponding visualizations that illustrate the relationships more clearly. 

Due to the delicate nature of the survey and to avoid possible misinterpretation/misrepresentation of subjects, care was taken in planning how each variable and question were coded.

\  

### Gender

One of the biggest questions we had with our survey data was the question of gender identity. Traditionally, studies looking at gender differences versus educational attainment have assumed a strict male/female gender binary.
Even more recent studies have taken into account nonbinary gender as a survey question, but did not include the relatively small number of respondents identifying as nonbinary in their analysis. [@clancy]
We found neither of these approaches satisfactory. We, along with Dr. Kottke, felt it irresponsible to assume a gender binary in our survey questioning. And while the analytical shortcut of ignoring nonbinary participants might have surved Clancy et. al.'s purposes, given their low number and proportion of nonbinary respondents (n, x%),  we found a much larger proportion of our survey sample identifying as nonbinary (n, x%), a group that we can not ignore for statistical reasons as well as moral reasons.

This forced us to question what exactly we wanted to measure as a predictor variable: Gender identity, gender conformity, masculinity, or femininity.
We ended up focusing on the role of masculinity, given that articles with queer-focused and intersectional prespectives specifically talk about the "masculine nature of both math and sciences"[@yodermattheis 22], or the "male superiority myth"[@leyva 399]. Our issue appears to be one of masculinity specifically.

WIth this in mind, instead of looking at gender identity, we looked at masculinity as a predictor. We transformed our responses to the gender identity question into a binary variable of whether the respondent self-identified as male, or not. Only responses where a survey participant checked the box indicating "Male" were coded as "yes" for the variable; all "Female" box checks or "Other" answers (including if the subject indicated they were a trans man, but did not check the "Male" box), were coded as "no". This is an approach we had not found addressed in literature, but with substantially higher nonbinary participation on a survey that was not specifically targeted at nonbinary or transgender individuals, we found ourselves facing relatively novel circumstances.

\  

### Ethinicity

Given the nature of Florida demographics, respondents were grouped into two groups: non-hispanic whites and everyone else, minorities. The goal was to see whether being a minority would influence the students' answers.


\  

### AOC

Since the focus is on math classes, we decided to group students into two groups as well: those who have a declared STEM AOC and those who do not.


\  

### Issues and Corrections

The problem with using Likert-type scales and ordinal responses is how to choose the appropriate statistical treatment of the data. Our data is ordinal, so non-parametric statistics are typically considered the most appropriate option for analysis. Likert scales may be subject to distortion from several causes; (1) **non-response bias**: the phenomenon that the required information is not obtained from the people selected in the sample; (2) **social desirability and acquiescence bias**: students may avoid using extreme response categories out of a desire of being perceived as having extremist views and may tend to aree with statements as presented.

\  

#### Corrections

- Design questions with students' sensitivity in mind; e.g. asking directly what their assessment of their own levels of confidence may not yield usable data due to issues mentioned above. Dr. Kottke consulted with professionals in the counseling center to assure the questions were worded in the most optimal way.

- Having a scale design with balanced keying (an equal number of positive and negative statements regarding each position or issue in question) can mitigate the random error caused by acquiescence bias. All survey questions with likert-items for responses are 5-item types which are balanced by design.

\  

# Analysis

This report makes use of three statistical tools: 

(1) Contingency tables and tests of association
(2) Ordinal Logistic Regression and 
(3) Mann-Whitney U tests

Future considerations:

+ Using sliders instead of the typical five-level format would yielf a continuous response variable which would expand the number of tests that could be used for analysis.
+ Including more options for gender and ethnicity entries would make the cleaning process more straight forward and requiring less assumptions about the subjects.

\  

## Cleaning up data


\  
We start by reading in the anonymized data from the file:

```{r echo=FALSE}
raw <- read.csv("survey_responses.csv",nrows = 264)
```


```{r read_data}
# Reading data in
raw_data <- read.csv("survey_responses.csv",nrows = 264)
```

\  

Taking a look at the raw data will show you that each header for the columns has the full question or partial question depending on the order of the form. 


```{r eval=TRUE, echo=FALSE}
head(raw[1:26])
```

\  

Here, we create a dictionary that allows for an easier manipulation of the data:

```{r create_dictionary}
# Reassigning column names, and creating dictionary for new column names
num_questions <- ncol(raw_data)
questions <- data.frame(colnames(raw_data))
new_col_names <- paste("Q",as.character(c(1:num_questions)),sep = "")
colnames(raw_data) <- new_col_names
data_dictionary <- data.frame(cbind(questions,new_col_names))

# Save raw data with new column names to "data" which will be normalized
data <- raw_data 
```

\  

Each column was named `Q` numbered by the order in the form:

```{r eval=TRUE, echo=FALSE}
head(data[1:26])
```

\  

Now we start normalizing the gender responses. Here we normalize the column corresponding to the first question into binary data based on whether the responder reported their gender as `"Male"` or not. The responses will be stored as strings (`"Male"` and `"Not Male"`) to make them easier to interpret in the visualization that will follow each question.

```{r normalizing_gender_visualizations}
gender_col <- as.character(data$Q1)
non_male <- gender_col != "Male"
gender_col[non_male] <-  "Not Male"
gender_col <- as.factor(gender_col)
data$Q1 <- gender_col
```

\

For clarity, we add a column named `gender` that maps `Male` to `1` and `Not Male` to `0` to be used in the logistic regression as a binary variable:

```{r normalizing_gender_olr}
map_gender <- function(rec) {
  if (rec == "Male") return(1) else return(0)
}
gender <- sapply(X = data$Q1, FUN = map_gender)
data <- cbind(data,gender)
```

\  

Next we normalize ethnicity. We take the data contained in the second question "What gender do you identify as?" or `Q2`. We use the `colnames()` function to set the column names for the new matrix we are creating that will group each subject according to the ethnicity they reported:


```{r normalizing_ethnicity_1}
ethnicity <- data.frame(data$Q2)
colnames(ethnicity) <- c("ethnicity_list")
```
\  

Here we add each of the groups we identified from the responses the students could choose from and the ones they entered in the freeform box:

```{r normalizing_ethnicity_2}
ethnicity[ethnicity$ethnicity_list %in% c("Arab", "Middle Eastern"), ] <- "White"
ethnicity[ethnicity$ethnicity_list == "Black or African American, Hispanic or Latino, Multi-Racial", ] <- "Black or African American, Hispanic or Latino"
ethnicity[ethnicity$ethnicity_list == "Mixed, Jamaican/Itailian/Chinese", ] <- "Asian, Black or African American, White"
ethnicity[ethnicity$ethnicity_list %in% c("Alien", "I do not wish to declare my race/ethnicity", ""), ] <- NA
ethnicity$ethnicity_list <- droplevels(ethnicity$ethnicity_list)
```
\  

Getting the correct ethnic groups:
```{r normalizing_ethnicity_3}
ethnicity_groups <- levels(ethnicity$ethnicity_list) %>% strsplit(", ") %>% unlist %>% unique
ethnicity_groups <- ethnicity_groups[!grepl(",", ethnicity_groups)]
```


\  

Recasting the ethnicity table with the comma-separated list into a new table:
```{r normalizing_ethnicity_4}
ethnicity <- ethnicity %>%
  rowid_to_column("id") %>%
  mutate(ethnic_group = strsplit(as.character(ethnicity_list), ", ")) %>%
  unnest() %>%
  dcast(id ~ ethnic_group)

# We get "White" and NA in the white column, for example
ethnicity[, -1] <- !is.na(ethnicity)[,-1]

# 2 new columns, non-hispanic white and only white or asian
ethnicity$"Non-Hispanic White" <- !(rowSums(ethnicity[, c("Asian", "Black or African American", "Hispanic or Latino", "Native Hawaiian or Other Pacific Islander", "NA")]) > 0)
ethnicity$"Only White or Asian" <- !(rowSums(ethnicity[, c("Black or African American", "Hispanic or Latino", "Native Hawaiian or Other Pacific Islander", "NA")]) > 0)

data <- cbind(data, ethnicity[, -1])
```

\ 

Here we start normalizing the various replies we got for AOC:

```{r normalizing_aoc}
stem_search_criteria <- c("bio", "comp sci", "compsci", "computer", "data", "natsci", "nat sci", "natural sci", "math", "chem",
                          # The fun ones:
                          "Marine Science", "Conputer Science")
data$is_stem_aoc <- stri_detect_regex(data$Q4, paste(stem_search_criteria, collapse='|'), case_insensitive=TRUE)
```

\  

Since most responses are on an ordinal scale, the code below reorders the factors so that they will be in the correct order. Without this reordering, the responses are simply ordered alphabetically:

```{r order_factors}
data$Q3 <-  factor(data$Q3,levels(data$Q3)[c(2,4,5,3,1)], ordered = TRUE)
data$Q6 <-  factor(data$Q6,levels(data$Q6)[c(2,1)], ordered = TRUE)
data$Q7 <-  factor(data$Q7,levels(data$Q7)[c(2,1,3)], ordered = TRUE)

agree_questions <- data[,8:14]
agree_questions <- catcolwise( function(my_col) factor(my_col,levels(my_col)[c(5,2,3,1,4)], ordered = TRUE))(agree_questions)
data[,8:14] <- agree_questions

average_questions <- data[,15:19]
average_questions <- catcolwise( function(my_col) factor(my_col,levels(my_col)[c(5,3,2,1,4)], ordered = TRUE))(average_questions)
data[,15:19] <- average_questions

data$Q20 <- factor(data$Q20,levels(data$Q20)[c(5,3,1,2,4)], ordered = TRUE)
data$Q22 <- factor(data$Q22,levels(data$Q22)[c(5,2,3,1,4)], ordered = TRUE)
data$Q23 <- factor(data$Q23,levels(data$Q23)[c(2,4,3,1)], ordered = TRUE)
data$Q24 <- factor(data$Q24,levels(data$Q24)[c(5,3,1,2,4)], ordered = TRUE)
data$Q25 <- factor(data$Q25,levels(data$Q25)[c(1,3,2)], ordered = TRUE)
data$Q26 <- factor(data$Q26,levels(data$Q26)[c(1,3,2)], ordered = TRUE)
```

\  

The data is prepared for plotting by remapping race and ethnicity for easier visualization, reformatting some of the responses for the legend, and providing functions for plotting either the overall responses, responses grouped by gender, and responses grouped by race/ethnicity.  

```{r plot_prep, echo=FALSE, results='hide'}
plot_data <- data

assign_ethnicity <- function(record) {
  if (sum(record) > 1) return("Multiethnic")
  if (sum(record) == 0) return(NA)
  if (record[1] == TRUE) return("Asian")
  if (record[2] == TRUE) return("Black or African American")
  if (record[3] == TRUE) return("Hispanic or Latino")
  if (record[4] == TRUE) return("Native Hawaiian or Other Pacific Islander")
  if (record[5] == TRUE) return("White")
}
race_ethnicity_data <- data[,ethnicity_groups]

overall_race_ethnicity <- data.frame(apply(race_ethnicity_data, MARGIN = 1, FUN = assign_ethnicity))
colnames(overall_race_ethnicity) <- "Race/Ethnicity"
plot_data <- cbind(plot_data,overall_race_ethnicity)
plot_data <- na.omit(plot_data)

plot_data$`Race/Ethnicity` <-  factor(plot_data$`Race/Ethnicity`,levels(plot_data$`Race/Ethnicity`)[c(1:3,5,4)])

plot_data$Q25 <- mapvalues(plot_data$Q25, from = levels(plot_data$Q25), to = c("No","Yes, but not at NCF","Yes, at NCF & elsewhere"))

plot_data$Q26 <- mapvalues(plot_data$Q26, from = levels(plot_data$Q26), to = c("No","Yes, but not at NCF","Yes, at NCF & elsewhere"))

cbPalette <- c("#4e5d90", "#9ba6ce", "#d9e8f0", "#c3c3c3", "#5a5858")

plot_overall <- function(question_col, question_title) {
  overall_plot <- ggplot(plot_data, aes(x = question_col, fill = factor(question_col))) 
  overall_plot <- overall_plot + geom_bar() + coord_flip()
  overall_plot <- overall_plot + xlab("Response") + ylab("Count") + guides(fill=guide_legend(title=question_title,reverse=TRUE)) + scale_fill_manual(values=cbPalette)
  return(overall_plot)
}
plot_by_gender <- function(question_col, question_title) {
  gender_plot <- ggplot(plot_data, aes(x = Q1,fill = factor(question_col))) 
  gender_plot <- gender_plot + geom_bar(position="fill") + coord_flip()
  gender_plot <- gender_plot + xlab("Gender") + ylab("Percentage") + guides(fill=guide_legend(title=question_title,reverse=TRUE)) + scale_fill_manual(values=cbPalette)
  return(gender_plot)
}

plot_by_ethnicity <- function(question_col, question_title) {
  ethnicity_plot <- ggplot(plot_data, aes(x = `Race/Ethnicity`, fill = factor(question_col))) 
  ethnicity_plot <- ethnicity_plot + geom_bar(position="fill") + coord_flip()
  ethnicity_plot <- ethnicity_plot + ylab("Percentage") + guides(fill=guide_legend(title=question_title,reverse=TRUE)) + scale_fill_manual(values=cbPalette)
  return(ethnicity_plot)
}
```
\  
\  

## Contingency tables and test of association

A contingency table is a table showing the distribution of one variable in rows and another in columns, used to study the association between the two variables.

In the case of question 17, *"How would you rate your mathematical ability, compared to your social group?"*, we first needed to consolidate the five response groups into three; the chi-squared test assumes that each cell in the crosstab has an expected value of at least 5, and in the case of male-identifying students rating themselves well below average. 

On the chunk below we create the two functions we will be using:

```{r to_three_groups}
to_three_averages <- function(fctr){
  levels(fctr) <- c("Below average", "Below average", "Average", "Above average", "Above average")
  return(fctr)
}

to_three_agrees <- function(fctr){
  levels(fctr) <- c("Disagree", "Disagree", "Neutral", "Agree", "Agree")
  return(fctr)
}
```

\  

The actual EV is:

```{r crosstab_socialgroup_example, eval=TRUE, echo=TRUE}
gender_vs_social_group_perception <- table(data$Q1, data$Q17)
gender_vs_social_group_perception
```

```{r crosstab_socialgroup_3groups, eval=TRUE, echo=TRUE}
gender_vs_social_group_perception <- table(data$Q1, to_three_averages(data$Q17))
gender_vs_social_group_perception
chisq.test(gender_vs_social_group_perception)
#mantelhaen.test(gender_vs_social_group_perception)
```

When performing a chi-squared test of independence, we do not find a significant result. We cannot conclude that a student's gender leads to a different response on this survey question.

\  

## Logistic Regression

Ordinal Regression is an extension of binomial logistics regression; it is used to predict the dependent variable with 'ordered' multiple categories and independent variables. In other words, we use it to facilitate the interaction of dependent variables (having multiple ordered levels) with one or more independent variables. 

In this report, our dependent variables will be the issues we are trying to study: anxiety levels, sense of belonging, discrimination felt, etc. The independent variables will be gender, ethinicity, year, AOC because we are trying to see if there is any evidence of a relationship between those specific characteristics and the issues mentioned above.

For our regression model to be realistic, we must account for the order of the likert items in our response variable. 


```{r general_predictors}
# Ethnicity
is_non_hispanic_white <- data$`Non-Hispanic White`
is_minority <- as.numeric(!is_non_hispanic_white)
is_asian <- as.numeric(data$Asian)
# What year the student is in
year <- as.numeric(data$Q3) #Survey responses were ordered in cleaning
# Whether the student's AOC is stem or not
is_stem <- as.numeric(data$is_stem_aoc)
```

\  

Let's start with the descriptive statistics of these variables:

```{r olr_descriptive_statistics}
ftable(xtabs(~ gender + is_minority + year + is_stem, data = data))
```

\  

As discussed in previous section, `gender` is a binary variable where `1` corresponds to male and `0` to non-male students. `is_minority` groups students into whether or not are non-hispanic white (i.e., belong to the majortiy of population in Florida), `0`, or if they are of other ethicities, `1`. `year` corresponds to whether a student is a freshman, `1`, sophomore, `2`, junior `3`, senior `4`, or they are doing an extra year or more `5`. `is_stem` corresponds to whether their AOC is STEM, `1` or not, `0`. We can also examine the distribution of `gender` at every level of `anxiety_level` responses. To do this we use 

Compared to other subjects, do you feel more or less anxiety in mathematics classes?
```{r echo=FALSE, fig.keep='all'}
q22_data <- plot_data$Q22
q22_title <- "More or less anxiety\nin math classes?"
plot_by_gender(q22_data,q22_title)
plot_by_ethnicity(q22_data,q22_title)
```

<!-- barplot(table(gender,anxiety_level),beside=T, -->
<!-- cex.names=0.7,legend.text=c("Not Male","Male"), -->
<!-- args.legend=list(x=15,y=65,cex=0.8), -->
<!-- density = seq(4,40,length.out=2), -->
<!-- angle=c(-60,60), -->
<!-- main = "Compared to other subjects, do you feel more or -->
<!-- less anxiety in mathematics classes?", -->
<!-- col=c("black","black")) -->

<!-- ```{r graph, echo=FALSE} -->
<!-- ggplot(data, aes(x=anxiety_level, y=gender))+geom_jitter(size=2, alpha=0.4, position = position_jitter(height = .02))+ -->
<!--   scale_y_discrete(breaks=seq(0,1)) + -->
<!--   xlab("Anxiety Level") + -->
<!--   ylab("Gender") + -->
<!--   ggtitle("Compared to other subjects, do you feel more or less anxiety in math classes?") + -->
<!--   theme_gray() -->


<!-- ``` -->

#### Anxiety levels

Below we use the `polr` command from the `MASS` package to estimate an ordered logistic regression model. The command name comes from proportional odds logistic regression, highlighting the proportional odds assumption in our model. `polr` uses the standard formula interface in `R` for specifying a regression model with outcome followed by predictors. We also specify `Hess=TRUE` to have the model return the observed information matrix from optimization (called the Hessian) which is used to get standard errors.

```{r OLR_function, eval=TRUE, echo=TRUE, warning=FALSE}
# Getting responses from question 22
anxiety_level <- data$Q22

# Fit ordered logit model and store results in 'anxiety_model'
anxiety_model <- polr(anxiety_level ~ gender + is_minority + year + is_stem, data = data, Hess = TRUE)

# View a summary of the model
summary(anxiety_model)
```

\  

In the output above, we see

1. **Call**: What type of model we ran, what options we specified, etc.

2. **Coefficients**: Regression output coefficient table including the value of each coefficient, standard errors, and t-value, which is simply the ratio of the coefficient to its standard error. There is no significance test by default.

3. **Intercepts**: Sometimes called cutpoints, the intercepts indicate where the latent variable is cut to make the three groups that we observe in our data. Note that this latent variable is continuous. In general, these are not used in the interpretation of the results. 

4. **Residual deviance**: `-2 * Log Likelihood` of the model as well as the `AIC`. Both the deviance and `AIC` are useful for model comparison.


Standard interpretation of the ordered log-odds coefficient is that for a one unit increase in the predictor, the response variable level is expected to change by its respective regression coefficient in the ordered log-odds scale while the other variables in the model are held constant.

Again, the nature of the test does not include a p-value by default. However, one way to calculate it in this case is by comparing the t-value against the standard normal distribution, like a z-test. Of course this is only true with infinite degrees of freedom, but is reasonably approximated by large samples, becoming increasingly biased as sample size decreases.

\  

First we store the coefficient table, then calculate the pvalues and combine back with the table. Storing the table:

```{r olr_table}
(coefficients_table <- coef(summary(anxiety_model)))
```

\  

Calculating and storing p-values:

```{r olr_p_values, eval=TRUE, echo=TRUE}
p_values <- pnorm(abs(coefficients_table[, "t value"]), lower.tail = FALSE) * 2

# Combined table
(coefficients_table <- cbind(coefficients_table, "p value" = p_values))
```

\  

We can also get confidence intervals for the parameter estimates. These can be obtained either by profiling the likelihood function or by using the standard errors and assuming a normal distribution. Note that profiled CIs are not symmetric (although they are usually close to symmetric). If the 95% CI does not cross 0, the parameter estimate is statistically significant.

```{r olr_ci}
# default method gives profiled CIs
# suppressMessages() is included to supress the warning
(suppressMessages(olr_ci <- confint(anxiety_model))) 
# CIs assuming normality
confint.default(anxiety_model) 
```

\  

The confidence intervals for both `gender` and `is_stem` do not include 0; `is_minority` and `year` do: **There is evidence to support that a student's gender and AOC are statistically significant predictors of their reported anxiety levels.**

The estimates in the output are given in units of ordered logits, or ordered log odds. So for `gender`, we would say that for a one unit increase in pared (i.e., going from 0 to 1), we expect a `1.10` increase in the expect value of `anxiety_levels` on the log odds scale, given all of the other variables in the model are held constant. 

For `is_stem`, we would say that for a one unit increase in `is_stem`, we would expect a `0.73` increase in the expected value of `anxiety_levels` in the log odds scale, given that all of the other variables in the model are held constant.

The coefficients from the model can be somewhat difficult to interpret because they are scaled in terms of logs. Another way to interpret logistic regression models is to convert the coefficients into odds ratios. To get the OR and confidence intervals, we just exponentiate the estimates and confidence intervals.

```{r}
## Odds ratios (OR)
exp(coef(anxiety_model))
```
\  

Combining the two:

```{r}
## OR and CI
exp(cbind(OR = coef(anxiety_model), olr_ci))
```

\  

These coefficients are called proportional odds ratios and we would interpret these pretty much as we would odds ratios from a binary logistic regression. 

Interpreting these Odds ratios we are essentially comparing the people who are in groups greater than $x$ versus
those who are in groups less than or equal to $x$, where $x$ is the level of the response variable. Hence for a one unit
change in the predictor variable, the odds for cases in a group that is greater than $x$ versus less than or equal to
$x$ are the proportional odds times larger. 

In this case, for a one unit increase in the `gender`variable (i.e., going from `0` (Not male) to `1` (Male)), the odds of high `anxiety_level` responses versus the combined adjacent `anxiety_level` categories are 3.016 times greater, given the other variables are held constant in the model. For a one unit increase in the `is_stem`variable (i.e., going from `0` (Non STEM AOC) to `1` (STEM AOC)), the odds of high `anxiety_level` responses versus the combined adjacent `anxiety_level` categories are 2.074 times greater, given the other variables are held constant in the model.

\  

Now to automate the steps above:

```{r olr_function, echo=TRUE}
#Creating function for the steps above
get_olr <- function(response, df){
  model <- polr(response ~ gender + is_minority + year + is_stem, data = df, Hess = TRUE)
  coefficients_table <- coef(summary(model))
  summary <- summary(model)
  p_values <- pnorm(abs(coefficients_table[, "t value"]), lower.tail = FALSE) * 2
  coefficients_table <- cbind(coefficients_table, "p value" = p_values)
  coefficients <- summary(model)$coefficients[1:4,1]
  suppressMessages(olr_ci <- confint(model))
  exp <- exp(coef(model))
  return (list(paste("Coefficients"), coefficients, paste("Confidence intervals:"),olr_ci, paste("Odds Ratio:"), exp))
}
```

\  

#### Confidence level

```{r olr_confidence_level, eval=TRUE, echo=TRUE}
# Grabing our response variable from question 16
confidence_level <- data$Q16

# Calling OLR
get_olr(confidence_level, data)
```

\  

`Confidence interval`

The confidence intervals for `gender`, `year`, and `is_stem` do not include 0; `is_minority` does: **There is evidence to support that a student's gender, year, and AOC are statistically significant predictors of their reported confidence levels in mathematics classes.**

We would say that for a one unit increase in `gender` (from not male to male), we expect a `1.15` increase in the expected value of `confidence_levels` on the log odds scale, given all of the other variables in the model are held constant. 

For `year`, we would say that for a one unit increase in `year`, we would expect a `0.29` increase in the expected value of `confidence_levels` in the log odds scale, given that all of the other variables in the model are held constant.

For `is_stem`, we would say that for a one unit increase in `is_stem`, we would expect a `1.40` increase in the expected value of `confidence_levels` in the log odds scale, given that all of the other variables in the model are held constant.


+ **Odds Ratio**

For a one unit increase in the `gender` variable, i.e., going from `0` (Not male) to `1` (Male), the odds of higher `confidence_levels` versus the combined adjacent response categories for the question is 3.15 times greater given the other variables are held constant in the model. For a one unit increase in the `year` variable, the odds of higher `confidence_levels` versus the combined adjacent response categories for the question is 1.33 times greater given the other variables are held constant in the model. For `is_stem` the number is 4.05, showing that being STEM major or not is highly influential as to how students feel in math classes.

\  

#### Gender Discrimination

```{r olr_gender_discrimination, eval=TRUE, echo=TRUE}
# Getting response data from question 25
gender_discrimination_felt <- data$Q25
# Calling OLR
get_olr(gender_discrimination_felt, data)
```

\  

+ **Confidence interval**

The confidence intervals for `gender`, and `year` do not include 0; `is_minority` and `is_stem` do: **There is evidence to support that a student's gender and year are statistically significant predictors of their reported feelings of gender discrimination in mathematics classes.**

We would say that for a one unit increase in `gender` (from not male to male), we expect a `2.43` *decrease* in the expected value of `gender_discrimination_felt` on the log odds scale, given all of the other variables in the model are held constant. 

For `year`, we would say that for a one unit increase in `year`, we would expect a `0.32` increase in the expected value of `gender_discrimination_felt` in the log odds scale, given that all of the other variables in the model are held constant.

+ **Odds Ratio**

For a one unit increase in the `gender` variable, the odds of higher perceived `gender_discrimination` versus the combined adjacent response categories for the question is 0.08 times greater given the other variables are held constant in the model. For a one unit increase in the `year` variable, the odds of higher perceived `gender_discrimination` versus the combined adjacent response categories for the question is 1.38 times greater given the other variables are held constant in the model.


\  

#### Stereotype threat

```{r olr_stereotype, eval=TRUE, echo=TRUE}
# Getting response data from question 23
stereotype_threat_felt <- data$Q23
# Calling OLR
get_olr(stereotype_threat_felt, data)
```

\  

+ `Confidence interval`

The confidence intervals for `gender`, and `is_minority` do not include 0; `year` and `is_stem` do: **There is evidence to support that a student's gender and ethnicity are statistically significant predictors of their reported feelings of being a target of stereotype threat in mathematics classes.**

We would say that for a one unit increase in `gender` (from not male to male), we expect a `1.23` increase in the expected value of `stereotype_threat` on the log odds scale, given all of the other variables in the model are held constant. 

For `is_minority`, we would expect a `-0.72` *decrease* in the expected value of `stereotype_threat` in the log odds scale, given that all of the other variables in the model are held constant.

+ **Odds Ratio**

For a one unit increase in the `gender` and `is_minority` variables, the odds of higher perceived `stereotype_threat` versus the combined adjacent response categories for the question are, respectively, 3.452 and 0.483 times greater given the other variables are held constant in the model.


\  


#### Gender discrimination

```{r olr_racial_discrimination, eval=TRUE, echo=TRUE}
# Getting response data from question 26
racial_discrimination_felt <- data$Q26
# Calling OLR
get_olr(racial_discrimination_felt, data)
```

\  

+ `Confidence interval`

The confidence intervals for `gender`, and `year` do not include 0; `is_minority` and `is_stem` do: **There is evidence to support that a student's gender and year are statistically significant predictors of their reported feelings of gender discrimination in mathematics classes.**

We would say that for a one unit increase in `gender` (from not male to male), we expect a `2.43` *decrease* in the expected value of `gender_discrimination_felt` on the log odds scale, given all of the other variables in the model are held constant. 

For `year`, we would say that for a one unit increase in `year`, we would expect a `0.32` increase in the expected value of `gender_discrimination_felt` in the log odds scale, given that all of the other variables in the model are held constant.

+ `OR and CI`

For `gender`, we would say that for a one unit increase in `gender`, i.e., going from `0` (Not male) to `1` (Male), the odds of *"Yes, at New College and possibly elsewhere"* applying versus *"Yes, but **not** at New College"* or *"No"* applying combined are `2.23` lower, given that all of the other variables in the model are held constant.

\  


#### Sense of belonging

```{r olr_belonging, eval=TRUE, echo=TRUE}
# Getting response data from question 24
sense_of_belonging <- data$Q24
# Calling OLR
get_olr(sense_of_belonging, data)
```

\  

+ **Confidence interval**

The confidence intervals for `gender`, and `is_stem` do not include 0; `is_minority` and `year` do: **There is evidence to support that a student's gender and AOC are statistically significant predictors of their sense of belonging in mathematics classes.**

We would say that for a one unit increase in `gender` (from not male to male), we expect a `0.95` increase in the expected value of `sense_of_belonging` on the log odds scale, given all of the other variables in the model are held constant. 

For `is_stem`, we would expect a `1.22` increase in the expected value of `sense_of_belonging` in the log odds scale, given that all of the other variables in the model are held constant.

+ **Odds Ratio**

For`gender`, a one unit increase in this variable, the odds of high `sense_of_belonging` versus the combined adjacent response categories for the question are  2.570 times greater, given the other variables are held constant in the model. For a one unit increase in the `is_stem` variable (from a non-STEM AOC to a STEM AOC), the odds of high `sense_of_belonging` versus the combined adjacent response categories for the question are 3.40 times greater, given the other variables are held constant in the model.


\  

#### Things to consider

1. **Sample size:** Both ordered logistic and ordered probit, using maximum likelihood estimates, require sufficient sample size. How big is big is a topic of some debate, but they almost always require *more* cases than OLS regression.

2. **Pseudo-R-squared:** There is no exact analog of the R-squared found in OLS. There are many versions of pseudo-R-squares. 

3. **Diagnostics:** Doing diagnostics for non-linear models is difficult, and ordered logit/probit models are even more difficult than binary models.

\  
\  

## Mann-Whitney U test

The Mann-Whitney U test is a nonparametric test of the null hypothesis that it is equally likely that a randomly selected value from one sample will be less than or greater than a randomly selected value from a second sample. Unlike the t-test it does not require the assumption of normal distributions. This test can be used to determine whether two independent samples were selected from populations having the same distribution. 

Defining the function to perform the test:

```{r mann_whitney}
get_mann_whitney <- function(ind_col, dep_col, df) {
  mw_stat <- wilcox.test(as.numeric(dep_col) ~ as.numeric(ind_col), data = df)
  return(mw_stat)
} 
```


<!-- *** -->

<!-- **Question 7:** *Are you interested in graduate school (in any discipline)?*  -->

<!-- **Possible answers:** "No", "Maybe", or "Yes"  -->

<!-- *** -->

<!-- All responses for this question were divided into two samples based on gender. One sample for all the male respondents and one sample for all of the non-male respondents.   -->

<!-- **$H_0:$ the two samples are from the same distribution**, i.e. there is significant difference between responses from male students and non-male students   -->

<!-- **$H_a:$ the two samples are from two different distributions**, i.e. there is a significant difference between responses from male students and non-male students. The type-two error is $\alpha = .05$. -->

<!-- ```{r q7_mann_whitney, eval=TRUE, echo=TRUE} -->
<!-- q7_mw_results <- get_mann_whitney(data$Q1, data$Q7, data) -->
<!-- q7_mw_results -->
<!-- ``` -->

<!-- With a p-value of 0.1708 we fail to reject the null hypothesis and conclude that there is no statistically significant difference between the responses of male students and non-male students when asked about their interest in graduate school.    -->

<!-- \   -->

***

**Question 23:** *How often are you concerned that your performance in math will confirm a negative stereotype about you?* 

**Possible answers:** "Often", "Sometimes", "Rarely", or "Never"

***

All responses for this question were divided into two samples based on gender. One sample for all the male respondents and one sample for all of the non-male respondents.  

**$H_0:$ the two samples are from the same distribution**, i.e. there is significant difference between responses from male students and non-male students  

**$H_a:$ the two samples are from two different distributions**, i.e. there is a significant difference between responses from male students and non-male students. The type-two error is still $\alpha = .05$  

```{r q23_mann_whitney, eval=TRUE, echo=TRUE}
q23_mw_results <- get_mann_whitney(data$Q1, data$Q23, data)
q23_mw_results
```

With a p-value of $2.465 \times 10^{-6}$ we **reject** the null hypothesis and conclude that there is a statistically significant difference between the responses of male students and non-male students when asked about the frequency of concerns that their performance in math will confirm a negative stereotype about them.  

\  

## Goodness of Fit 

At first, we wanted to run a goodness of fit test to determine whether the responses from the sample of New College students who replied are consistent with the national statistics reported on gender and ethinicity distributions. 

Our hypotheses would have been: 

$H_0$: Our responses are consistent with a specified distribution and  

$H_a$: Our responses are not consistent with a specified distribution, 

where the specified distribution would be the one corresponding to the national statistics reported in websites such as [College Factual](https://www.collegefactual.com/colleges/new-college-of-florida/student-life/diversity/). We did not include the test because (1) it is a big jump to go from our survey responses to data that was collected in a completely different way across the country. To do that, we would have had to have access to similar metrics collected by the institutional research department at New College, for example. This is something that can be explored in the future if there is interest.

\  

# Appendix

Below are descriptive statistics that break down the responses for each question by gender and ethnicity.
\  

## What gender do you identify as?
\  

```{r plot_q1, eval=TRUE, echo=FALSE, fig.keep='all'}
other <- (raw_data$Q1 != "Male" & raw_data$Q1 != "Female")
raw_gender <- as.character(raw_data$Q1)
raw_gender[other] <- "Other"
raw_gender <- data.frame((as.factor(raw_gender)))
colnames(raw_gender) <- "Gender"
ggplot(raw_gender,aes(Gender, fill = Gender)) + geom_bar() + coord_flip() + guides(fill=FALSE) + scale_fill_manual(values=cbPalette)
```
\ 

As mentioned in the overview, most respondents were female 60\%, followed by male, 28.3\%, and then non-binary students at 11.7\%.

```{r}
table(data$Q1)
```


\  

## What is your race/ethnicity?
\  

```{r plot_q2, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_q2 <- ggplot(plot_data, aes(`Race/Ethnicity`, fill = `Race/Ethnicity`)) 
plot_q2 + geom_bar() + coord_flip() + guides(fill=FALSE) + scale_fill_manual(values=cbPalette)
```
\  

The vast majority of students who replied to the survey are white. This falls in line with the ethnic diversity distribution at New College, where 68.9\% of students are white, 16.4\% are Hispanic/Latino. The remaining 14.7\% of students are either Asian, Black of African American, or have ethnicity unknown.

\  

## What is your year at New College?
\  

```{r plot_q3, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_q3 <- ggplot(plot_data, aes(x = Q3, fill = Q3))
plot_q3 + geom_bar() + xlab('Year') + guides(fill=FALSE) + scale_fill_manual(values=cbPalette)
```

\  

The majority of students who replied to the survey are first years. The number of respondents decreases sharply as the years increase.

\  

## What is your Area of Concentration?
\  


```{r plot_q4_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q4_data <- mapvalues(plot_data$is_stem_aoc, from = c(TRUE,FALSE), to = c("STEM","Not STEM"))
q4_title <- "AOC type \n"
plot_overall(q4_data,q4_title)
```
\  

Most of the respondents to the survey have a non-STEM AOC.

\  
```{r plot_q4_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q4_data,q4_title)
```

\  

As would be somewhat expected, the percentage of STEM AOCs holders is larger for male students who responded. The majority of non-male students that answered this survey are non-STEM majors.

\  

```{r plot_q4_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q4_data,q4_title)
```
\  

Of the people who responded to the survey, over 50\% of Asian and Multiethnic students have STEM AOCs. Hispanic/Latino, Black/African American, and White respondents are mostly non-STEM students.

\  

## Which math classes have you taken at New College?
\  

```{r plot_q5_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
math_classes <- data.frame(math_classes_list = plot_data$Q5)
math_classes_groups <- levels(math_classes$math_classes_list) %>% strsplit(", ") %>% unlist %>% unique
math_classes <- math_classes %>%
  rowid_to_column("id") %>%
  mutate(classes = strsplit(as.character(math_classes_list), ", ")) %>%
  unnest() %>%
  dcast(id ~ classes)
math_classes[, -1] <- !is.na(math_classes)[,-1]
math_classes <- cbind(gender = plot_data$Q1[math_classes$id],Ethnicity = plot_data$`Race/Ethnicity`[math_classes$id],math_classes[,-1])

#plot overall responses
overall <- data.frame(Count=apply(math_classes[,3:10],2,sum))
overall$Course = rownames(overall)
ggplot(data=overall, aes(x=Course, y=Count, fill=Course)) +
geom_bar(stat="identity") + coord_flip() + guides(fill=FALSE) + scale_fill_brewer()
```
\  
```{r plot_q5_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
#plot responses grouped by gender
classes_by_gender <- data.frame(Male=apply(math_classes[math_classes$gender == "Male",3:10],2,sum),NonMale=apply(math_classes[math_classes$gender == "Not Male",3:10],2,sum))
classes_by_gender$Course <-  rownames(classes_by_gender)
classes_by_gender <- melt(classes_by_gender)

ggplot(classes_by_gender, aes(x = Course, y = value)) +   
  geom_bar(aes(fill = variable), stat="identity") + coord_flip() + scale_fill_manual(values=cbPalette) + guides(fill=guide_legend(title="Math classes taken \n at NCF",reverse=TRUE)) + ylab("Percentage")
```


\  
```{r plot_q5_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
#plot responses grouped by ethnicity
classes_by_ethnicity <- data.frame(apply(math_classes[math_classes$Ethnicity == "Asian",3:10],2,sum),
                                   apply(math_classes[math_classes$Ethnicity == "Black or African American",3:10],2,sum),
                                   apply(math_classes[math_classes$Ethnicity == "Hispanic or Latino",3:10],2,sum),
                                   apply(math_classes[math_classes$Ethnicity == "White",3:10],2,sum),
                                   apply(math_classes[math_classes$Ethnicity == "Multiethnic",3:10],2,sum))
colnames(classes_by_ethnicity) <- c("Asian","Black or African American", "Hispanic or Latino","White","Multiethnic")
classes_by_ethnicity$Course <-  rownames(classes_by_ethnicity)
classes_by_ethnicity <- melt(classes_by_ethnicity)

ggplot(classes_by_ethnicity, aes(x = Course, y = value)) +   
  geom_bar(aes(fill = variable), stat="identity") + coord_flip() + scale_fill_manual(values=cbPalette) + guides(fill=guide_legend(title="Math classes taken \n at NCF",reverse=TRUE)) + ylab("Percentage")
```


## Are you considering, or did you ever consider a concentration in Math?
\  
```{r plot_q6_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q6_data <- plot_data$Q6
q6_title <- "Ever consider AOC\nin Math? \n"
plot_overall(q6_data,q6_title)
```
\  

```{r plot_q6_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q6_data,q6_title)
```
\  

In both male and not-male respondents, the majority of students have not considered an AOC in Math.

\  
```{r plot_q6_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q6_data,q6_title)
```
\  

Similar results are seen when we break down by ethnicity, where in all cases over 50\% of the respondents have not considered an AOC in math.

\  

## Are you interested in graduate school, in any discipline?
\  
```{r plot_q7_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q7_data <- plot_data$Q7
q7_title <- "Interested in\ngrad school?\n"
plot_overall(q7_data,q7_title)
```
\  

An overwhelming majority of repondents have an interest in graduate school. 

\  
```{r plot_q7_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q7_data,q7_title)
```
\  

The *vast majority* of students in both gender groups are interested in graduate school. 

\  
```{r plot_q7_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q7_data,q7_title)
```
\  

The same can be seen when we break down by ethnicity with perhaps the exception of Hispanic/Latino students who seem to have a lower percentage of people interested in graduate school. Considering the small number of Hispanic/Latino respondents when compared with students of other ethnicities, we should consider the chance that this group may be under-represented.

\  

## "I find mathematics interesting."
\  

```{r plot_q8_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q8_data <- plot_data$Q8
q8_title <- "I find math\ninteresting. \n"
plot_overall(q8_data,q8_title)
```
\  

```{r plot_q8_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q8_data,q8_title)
```
\  

While most students in both groups seem to agree with the statement, a higher percentage of male students "Strongly Agree" with it while a comparatively higher percentage of not-male students "Strongly disagree."

\  
```{r plot_q8_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q8_data,q8_title)
```
\  

All groups have similar responses, with multiethnic respondents having the highest percentage of people answering with "Strongly Agree" at first glance. To see if this difference is actually significant, a proportion test can be performed.

\  

## "Mathematics leads to many possible career opportunities."
\  

```{r plot_q9_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q9_data <- plot_data$Q9
q9_title <- "Math leads to many\ncareer opportunities. \n"
plot_overall(q9_data,q9_title)
```
\  

```{r plot_q9_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q9_data,q9_title)
```
\  

Responses are similarly distributed between both groups.

\  

```{r plot q9_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q9_data,q9_title)
```
\  

When we break down by ethnicity, Asian respondents seem to feel more strongly about the statement when compared to other groups.

\  

## "With practice it is easy for me to improve my skills in math."
\  

```{r plot_q10_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q10_data <- plot_data$Q10
q10_title <- "It is easy to improve \n my math skills with \n practice \n"
plot_overall(q10_data,q10_title)
```
\  

```{r plot_q10_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q10_data,q10_title)
```
\  

When it comes to the statement "It is easy to improve my math skills with practice," not-male students have a higher percentage of responses of "Strongly Disagree" and "Disagree" as well as a lower percentage of "Strongly Agree" and "Agree" when compared to their male counterparts.

\  
```{r plot_q10_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q10_data,q10_title)
```
\  

Asian respondents seem to agree more strongly with the same statement when compared to other groups, especially the African American and Hispanic groups.

\  

## "Men are generally better suited to mathematics than women."
\  

```{r plot_q11_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q11_data <- plot_data$Q11
q11_title <- "Men are generally\nbetter at math. \n"
plot_overall(q11_data,q11_title)
```
\  

```{r plot_q11, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q11_data,q11_title)
```
\  

Fortunately, the vast majority of both gender groups seem to "Strongly disagree" with the statement: "Men are generally better at math." 

\  
```{r plot_q11_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q11_data,q11_title)
```
\  

The same is true when we break down by ethnicity, with the lowest percentages of "Strongly Disagree" coming from the African American and Asian respondents. 

\  

## "Many people believe that men are better suited to mathematics than women."
\  

```{r plot_q12_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q12_data <- plot_data$Q12
q12_title <- "Many believe that \n men are generally \n better at math. \n "
plot_overall(q12_data,q12_title)
```
\  

```{r plot_q12_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q12_data,q12_title)
```
\  

The answers here seem to reverse; the marjority of students in both groups "Agrees" with the statement while the not-male students show more than twice as much the percentage of "Strongly Agree" when compared to male students. While they feel very strongly about the statement, it seems that the students' perception of people around them is that people agree with the statement. 

\  

```{r plot_q12_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q12_data,q12_title)
```
\  

As expected, the same flip happens when we breakdown by ethnicity. Asian respondents reported a significatly higher percentage of "Strongly Disagree" answers when compared to their peers. African American students replied exclusively with "Stronly agree" and "Agree" statements.

\  

## "Some racial ethnic groups are generally better suited to mathematics than others."
\  

```{r plot_q13_overll, eval=TRUE, echo=FALSE, fig.keep='all'}
q13_data <- plot_data$Q13
q13_title <- "Some racial ethnic \n groups are generally \n better at math. \n "
plot_overall(q13_data,q13_title)
```
\  

```{r plot_q13_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q13_data,q13_title)
```
\  

The majority of both male and non-male students "Strongly Disagree" with this statement.

\  

```{r plot_q13_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q13_data,q13_title)
```
\  

We still verify the same when breaking down by ethnicity with the exception of Asian respondents who disagree with the statement less strongly when compared to other groups.

\  

## "Many people believe that some racial ethnic groups are better suited to mathematics than others."
\  

```{r plot_q14_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q14_data <- plot_data$Q14
q14_title <- "Many believe that \n some racial ethnic \n groups are generally \n better at math. \n "
plot_overall(q14_data,q14_title)
```
\  

```{r plot_q14_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q14_data,q14_title)
```
\  

This question also pertains to racial stereotypes (i.e., "All Asian students everywhere, always, are exceptionally good at math."). Similar to when the same question was posed about other people's view on if gender plays a role in mathematical ability, the responses here lean heavily towards "Strongly Agree" and "Agree" for both groups.

\  

```{r plot_q14_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q14_data,q14_title)
```
\  

When breaking down by ethnicity, we see a similar behavior when it comes to the Asian and African American groups; the former respondents disagree more strongly while the latter group replied exclusively with "Strongly agree" and "Agree" with the statement.

\  

## Rate your mathematical ability compared to your high school student population.
\  

```{r plot_q15_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q15_data <- plot_data$Q15
q15_title <- "Rate your math skills \n compared to your high \n school population. \n "
plot_by_gender(q15_data,q15_title)
```
\  

```{r plot_q15_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q15_data,q15_title)
```
\  

Male respondents responded significatly more often with "Strongly Agree" to this statement when compared to the non-male group, who also disagreed more and had a higher rate of "Average" responses.

\  

```{r plot_q15_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q15_data,q15_title)
```
\  

White, Multiethnic, and Asian respondents had the highest percentages of "Well above average" when comparing themselves to their highschool population, as opposed to African American students who replied with "Above average" more than any other response.

\  

## Rate your mathematical ability compared to the student population at New College.
\  

```{r plot_q16_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q16_data <- plot_data$Q16
q16_title <- "Rate your math skills \n compared to New \n College population. \n "
plot_overall(q16_data,q16_title)
```
\  

```{r plot_q16_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q16_data,q16_title)
```
\  

While both gender groups seem to have a similar amount of respondents feeling like they belong in the "Average" category, non-male students have the most number of "Below average" and "Well below average" by far, while male students also consider themselves "Above Average" and "Well above average" much more often when it comes to comparing their mathematicall ability to other New College studentss.

\  

```{r plot_q16_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q16_data,q16_title)
```
\  

African American and Asian respondents consider themselves more often "Above Average" and "Average" when comparing themselves to other New College students while Multiethnic and White students report to being "Below average" much more often.

\  

## Rate your mathematical ability compared to your social group.
\  

```{r plot_q17_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q17_data <- plot_data$Q17
q17_title <- "Rate your math skills \n compared to your \n social group. \n "
plot_overall(q17_data,q17_title)
```
\  

```{r plot_q17_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q17_data,q17_title)
```
\  

Both gender groupings have similar answers, with male respondents rating themselves "Well above average" and "Above average" slightly more often than non-male students when comparing their mathematical ability to their social group.

\  

```{r plot_q17_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q17_data,q17_title)
```
\  

Most groups rate themselves between "Well above average" and "Average" for the vast majority, with the exception of Asian respondents who marked "Well above average" and "Above average" more often than "Average."

\  

## Rate your mathematical ability compared to other students of your gender.
\  

```{r plot_q18_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q18_data <- plot_data$Q18
q18_title <- "Rate your math skills \n compared to students \n of your gender. \n"
plot_overall(q18_data,q18_title)
```
\  

```{r plot_q18_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
q18_data <- plot_data$Q18
q18_title <- "Rate your math skills \n compared to students \n of your gender. \n"
plot_by_gender(q18_data,q18_title)
```
\  

When comparing their mathematical ability to other students of the same gender, both groups reported to be "Average" quite a lot, with male students responding more than twice as much with "Well above average" and more with "Above average." The male students also reported less to being "Well below average" or "Below average" than the non-male students. 

Keep in mind that because of the binary grouping of gender into male and non-male, some information is lost when it comes to non-binary respondents because it gets lost with the female responses.

\  

```{r plot_q18_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q18_data,q18_title)
```

\  

When accounting for ethnicity, people seemed to pick less extreme responses to this question, in fact, Asian respondents only used "Above average" and "Average" responses. The group who feels more inferior to their gender counterparts is the Hispanic/Latino group, with the highest percentage of "Well below average" responses.

\  

## Rate your mathematical ability compared to other students of your racial ethnic group.
\  

```{r plot_q19_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q19_data <- plot_data$Q19
q19_title <- "Rate your math skills \n compared to students\n of your racial ethnic \n group. \n "
plot_overall(q19_data,q19_title)
```
\  

```{r plot_q19_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q19_data,q19_title)
```
\  

When comparing to their ethnic group, both gender groups seem to report a similar percentage of "Well below average" with male respondents once more having the higher rates of "Well above average" and "Above average" while the non-male respondents have the higher rates of "Below average" and "Average." 

\  

```{r plot_q19_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q19_data,q19_title)
```
\  

African American respondents stand out from other groups with a majority of "Well above average" and "Above average" responses when comparing their mathematical ability with other students of their racial ethnic group. Asian respondents report the highest percentage of "Well below average" when compared to students of the same ethnicity, witha  large portion of responses being "Average" and a very low number of responses being "Above average" and "Well above average," which contrasts to the group's response to the previous question where they answered with "Well above average" and "Above average" most of the time when comparing their mathematical skills to their high school population and social groups and New College population.

\  

## Imagine the following scenario: in the first few weeks of a math class, you have had difficulty understanding the material and completing some of the assignments. How likely are you to drop the class?
\  

```{r plot_q20, eval=TRUE, echo=FALSE, fig.keep='all'}
q20_data <- plot_data$Q20
q20_title <- "Likelihood of dropping \n a difficult math class. \n "
plot_overall(q20_data,q20_title)
```
\  

```{r plot_q20_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q20_data,q20_title)
```
\  

Male respondents tend to be much less likely to drop a class in that situation while non-male students report higher percentages of both "Very likely" and "Somewhat likely" when compared to males.

\  

```{r plot_q20_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q20_data,q20_title)
```
\  

Asian respondents report the highest percentage of being "Very unlikely" to drop a class in those circumstances while Hispanic/Latino and Multiethnic students show the highest percentages of being "Very likely" to do so. 

\  

## Have you ever dropped or stopped attending a math class because you believed you were not going to do well?
\  

```{r plot_q21_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q21_data <- plot_data$Q21
q21_title <- "Ever dropped a \n difficult math class? \n "
plot_overall(q21_data,q21_title)
```
\  

```{r plot_q21_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q21_data,q21_title)
```
\  

The majority of both groups have reported to have never dropped a difficult math class. Of those that did, non-male students report a slightly higher percentage than males for having done so.

\  

```{r plot_q21_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q21_data,q21_title)
```
\  

Asian respondest have, by far, the lowest percentage for having dropped a difficult math class, in accordance to the group's response to the previous question relating to how they would handle struggling with a math class at first. In contrast, Hispanic/Latino, African American, and Multiethnic respondents have the highest percentages for having done so but all groups report a vast majority of "No."

\  

## Compared to other subjects, do you feel more or less anxiety in mathematics classes?
\  

```{r plot_q22_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q22_data <- plot_data$Q22
q22_title <- "More or less anxiety \n in math classes? \n "
plot_overall(q22_data,q22_title)
```
\  

```{r plot_q22_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q22_data,q22_title)
```
\  

Non-male students report significantly higher percentages of "Much more anxiety" and anxiety levels in general when compared to male counterparts, who also were twice as likely to report "Much less anxiety" when compared with non-male students, and only a third of the non-male "Much more anxiety" percentage.

\  

```{r plot_q22_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q22_data,q22_title)
```
\  

Throuought the groups, the majority of respondents report having between "Much more anxiety" and "A little more anxiety" while the respondents who identify as Multiethnic report higher levels in general of "Much more anxiety."

\  

## How often are you concerned that your performance in math will confirm a negative stereotype about you?
\  

```{r plot_q23_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q23_data <- plot_data$Q23
q23_title <- "Frequency of concerns \n that your performance in \n math will confirm negative \n stereotypes about them \n "
plot_overall(q23_data,q23_title)
```
\  

```{r plot_q23_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q23_data,q23_title)
```
\  

The majority of male students replied with "Never" while the majority of non-male students replied with a combination of "Often" and "Sometimes."

\  

```{r plot_q23_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q23_data,q23_title)
```
\  

Asian, African American, and Hispanic/Latino students report the highest percentage of "Often" and "Sometimes" responses, while Multiethnic and White respondents have the highest percentages of "Never" responses.

\  

## Think about a typical math course you have taken at New College or imagine taking one. Did/do you feel comfortable or out of place?
\  

```{r plot_q24_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q24_data <- plot_data$Q24
q24_title <- "Feel comfortable \n or out of place in\n NCF math class? \n "
plot_overall(q24_data,q24_title)
```
\  

```{r plot_q24_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q24_data,q24_title)
```
\  

The majority of male students report higher levels of "Very comfortable" and "Somewhat comfortable" in New College math classes while almost 50\% of non-male students report "Very out of place" and "Somewhat out of place." This could be perhaps a good place to start asking concrete questions to students about what could be done to alleviate the situation. 

\  

```{r plot_q24_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q24_data,q24_title)
```
\  

All groups have similarly distributed responses, with the exception of Asian respondents who never reported to feel "Very out of place." 

\  

## Have you ever felt that you were perceived or treated differently in a math class due to your gender?
\  

```{r plot_q25_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q25_data <- plot_data$Q25
q25_title <- "Ever felt you were \n treated differently in \n math class due to \n your gender? \n "
plot_overall(q25_data,q25_title) 
```
\  

```{r plot_q25_by_gender, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_gender(q25_data,q25_title) 
```
\  

The *vast* majority of male respondents report "No", while almost 50\% of non-male respondents report "Yes."

\  

## Have you ever felt that you were perceived or treated differently in a math class due to your race or ethnicity?
\  

```{r plot_q26_overall, eval=TRUE, echo=FALSE, fig.keep='all'}
q26_data <- plot_data$Q26
q26_title <- "Ever felt you were \n treated differently in \n math class due to \n your race or ethnicity?"
plot_overall(q26_data,q26_title) 
```
\  

```{r plot_q26_by_ethnicity, eval=TRUE, echo=FALSE, fig.keep='all'}
plot_by_ethnicity(q26_data,q26_title) 
```
\  

Asian and Black/Afrincan American, and Multiethnic respondents report to have felt some form of racial discrimination while at NCF and elsewhere. Asian respondents have very low levels of "No" responses, with a large number of "Yes, but not at NCF" responses as well. Other groups have a majority of "No" responses.
\  



\  

# Conclusion

## Tests of association

In the case of question 17, “How would you rate your mathematical ability, compared to your social group?” we cannot conclude that a student’s gender leads to a different response on this survey question.

## OLR findings

1. There is evidence to support that a student's gender and AOC are statistically significant predictors of their reported anxiety levels in mathematics classes.

2. There is evidence to support that a student's gender, year, and AOC are statistically significant predictors of their reported confidence levels in mathematics classes.

3. There is evidence to support that a student's gender and year are statistically significant predictors of their reported feelings of gender discrimination in mathematics classes.

4. There is evidence to support that a student's gender and ethnicity are statistically significant predictors of their reported feelings of being a target of stereotype threat in mathematics classes.

5. There is evidence to support that a student's gender and year are statistically significant predictors of their reported feelings of gender discrimination in mathematics classes.

6. There is evidence to support that a student's gender and AOC are statistically significant predictors of their sense of belonging in mathematics classes.

## Mann-Whitney U tests

1. For question 7, "Are you interested in graduate school (in any discipline)?", we fail to reject the null hypothesis and conclude that there is no statistically significant difference between the responses of male students and non-male students when asked about their interest in graduate school.

2. For question 23, How often are you concerned that your performance in math will confirm a negative stereotype about you?, we reject the null hypothesis and conclude that there is a statistically significant difference between the responses of male students and non-male students when asked about the frequency of concerns that their performance in math will confirm a negative stereotype about them.

\  

## Comments

Below are some comments included in the survey:
\  


***

*Thank you for beginning to address disparities in the math department. I think that the department could be strengthened immensely with more work at helping non male, non white students feel comfortable.* 

*** 

*In my opinion, there is a bit of disparity in the STEM field when it comes to diversity. I know places like NYU have pushed programs like "Women in STEM" which is geared towards having high retention rates for women is STEM majors.  I feel like New College is a great liberal arts college with a focus on research. We, as a school in general, need to outreach to a more diverse population (ESPECIALLY when it comes to Math and NatSci AOCs).*

***

*I believe that NCF's math department is too theoretical. I had orginally come to college thinking I'd be an Applied Math AOC. My decision to switch had nothing really to do with the math department however. What I did notice though was that there weren't too many courses dedicated to real life application of math concepts. Additionally, and this goes for NCF as a whole, there needs to be gender and racial/ethnic diversity reflected amongst students, faculty, admin. and staff in order to truly be diverse.*

*** 
*As a student who needs academic accommodations, I feel that I have absolutely been treated differently in math classes across the board... in my experience, math teachers in general are more grudging to accommodate disabled students' needs in ways that teachers of other disciplines are more willing to do. (E.g.: you don't need to use a calculator, you should be able to do fast mental math just like everyone else)*

***

*With the stereotype question, you only address negative stereotypes. I'd also like to note that there is the phenomenon of "not confirming positive stereotypes" that can affect people as well, especially with groups as stereotyped as Asians are (i.e. the "Model Minority" stereotype). I have experienced, and read sociology papers that address the experience, of Asian American students feeling pressured to be better at math due to their race. There is also the experience of being worried that you're a "bad Asian" because you're "bad at math".*

***

*Thanks for this survey! It’s important to address issues of diversity in specific fields.*

***

*I find that a lot of students who identify as male are more likely to speak out and answer questions than other students in class. I feel more time should be given and hands should be raised so that all students get a chance to process the question and answer it.*

***

*I did well in math, never had to study for a test and still did well, until I hit Calculus.  Even with studying, I don't do well.*

***

*I think the change of name of the course from Calc with Theory to Honors Calculus was a very conscious and good-hearted decision, but I think it does not accurately reflect the difficulty and degree of difference of the course content when it is compared to a standard Honors Calc class at another college.* 

*I also am very thankful for all of the professors in the math department. They have always made me feel as capable and supported as I could ever imagine. Changing from studying science to studying philosophy, I'm still in a male-dominated environment and feel that math was much less toxic of an environment for women. I feel that women just tend to have a harder time doing things that are deemed to be more "useless" in society's eye (i.e. math and philosophy due to their abstract nature) and perhaps just celebrating the uniqueness of these more abstract subjects and educating first-year students on the nature of these subjects and the styles of thinking and approach that are taken would be good for women to hear. Instead of hearing their area of interest is useless and diverting them from it, they could hear that people like to think about theory (for instance, in philosophy) and the way things work in the world would like to be a part of the program.*

*I am also so happy this survey went out! There is a similar mechanism in the philosophy department due to the gender disparity and I am very glad it is happening here now. Thanks for all you all do!*

***

*Thank you for addressing the huge disparities in New College's math program. This is important data!*

***

*Very cool that you all put this survey together...*

***

*teaching style has influenced my love of math the most*

***

*I generally think that the math department here are quite good about gender and race diversity and respectful.*

***

*In general, it has been my experience, as well as my significant other's (female), that women are treated as less capable in STEM classes, and are often objectified instead of being considered for their academic capabilities; however, my best professors in STEM happen to have all been female; this is not to say my male professors were not as capable, but my female professors exuded a confidence only gained through years of 'fighting upstream.' Additionally, it has been my experience that diversity in all fields is extremely conducive to problem solving, as each perspective contributes a unique part of the solution. As the world has progressed, all modern STEM problems are of a level of complexity that requires significant human collaboration, and this collaboration is greatly benefitted by increased diversity.*

***

*I don't know why this question is necessary: "How would you rate your mathematical ability compared to other students of your gender or racial/ethnic identity."*

***

*New College's Mathematics Department is generally considered to be the most rigorous and challenging department on campus. Many students drop mathematics because of the workload, demanding coursework, and perceived expectations of their professors. I hope that we can build a more encouraging community. Many students of math at New College suffer emotionally.*

***

*New College, although has a high concentration with substantial high school math background, has pushed me to become better at Math and be less scared of spending extra time on material I dont understand. The QRC has helped me so much with understanding math both conceptually and in practice, which I didn't get before coming to this school.*

***

*As an asian american, average performance in math is considered poor with respect to our culture. I perform average,possibly below average, on calc III and some students ask me for help based on the stereotype that Asians are good at math. It really discourages me since my average performance in calc is not what the other students expect. I often get comments like "really? You did worse than I did, that's suprising". It's a microaggression that makes failure seem more daunting than it really is. Because of this, I often shy away from math despite the fact that I need more help.*

***

\  

\  

\  


