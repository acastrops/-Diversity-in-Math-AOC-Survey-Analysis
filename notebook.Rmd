---
title: "Diversity and Math Survey Analysis"
author: "Adriana Souza, Lydia Laseur, Roger Filmyer"
date: "November 12th, 2017"
output:
  html_notebook:
    highlight: tango
    mathjax: null
    number_sections: yes
    theme: spacelab
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
# Loading packages we will be using
library(srvyr)
library(psych)
library(shiny)
library(dplyr)
library(ggplot2)
library(tibble)
library(reshape2)
library(tidyr)
```


## Overview and motivation

This is a report created for Professor Chris Kottke's survey. Goals of the survey were to get more information about the students in order to address the lack of gender diversity in the math AOC. Dr. Kottke wanted to get a sense of how the students feel and test the incidence of things like belonging uncertainty, impostor syndrome, and stereotype threat at New College of Florida.

This report has three goals: 

(1) To generate visualizations as per requested by Dr. Kottke, 
(2) To conduct analysis focused on how the self-reported gender and ethinicty condition the responses, and 
(3) To be fully reproducible. 

One of the reasons was 

## Survey information

The population consists of New College students exclusively, given that only respondents with an *@ncf.edu* email address were allowed to reply. New College has 861 students (as of Fall 2016) and the survey had a total of 264 responses.

The data was de-identified for the purpose of this study so no IRB approval was required. The survey data was designed with the help of...


## Data

### Issues

## Analysis

Suggestions from Melissa:

+ Non-parametric rank-based inference such as the median, the Mann-Whitney U test, or the Kruskal Wallis test. 
+ But if we have a well-defined likert scale, we might still be able to get useful results with standard statistical summaries and inference as well (though Melissa is not sure whether the assumptions for standard linear regression would be met).
+  It could be interesting for your project to try (for example) to see what you find when you compare the means of two groups vs the medians of two groups. Or what do you find if you do a t-test vs a MW test? etc. 


### Setting up data

```{r data}
## Reading data in
data <- read.csv("survey_responses.csv")
```

```{r}
ethnicity <- data.frame(data$What.is.your.race.ethnicity...Check.all.that.apply.)
colnames(ethnicity) <- c("ethnicity_list")
ethnicity[ethnicity$ethnicity_list %in% c("Arab", "Middle Eastern"), ] <- "White"
ethnicity[ethnicity$ethnicity_list == "Black or African American, Hispanic or Latino, Multi-Racial", ] <- "Black or African American, Hispanic or Latino"
ethnicity[ethnicity$ethnicity_list == "Mixed, Jamaican/Itailian/Chinese", ] <- "Asian, Black or African American, White"
ethnicity[ethnicity$ethnicity_list %in% c("Alien", "I do not wish to declare my race/ethnicity", ""), ] <- NA
ethnicity$ethnicity_list <- droplevels(ethnicity$ethnicity_list)

ethnicity_groups <- levels(ethnicity$ethnicity_list) %>% strsplit(", ") %>% unlist %>% unique
ethnicity_groups <- ethnicity_groups[!grepl(",", ethnicity_groups)]


ethnicity <- ethnicity %>%
  rowid_to_column("id") %>%
  mutate(ethnic_group = strsplit(as.character(ethnicity_list), ", ")) %>%
  unnest() %>%
  dcast(id ~ ethnic_group)

# we get "White" and NA in the white column
ethnicity[, -1] <- !is.na(ethnicity)[,-1]

# 2 new columns, non-hispanic white and only white or asian
ethnicity$"Non-Hispanic White" <- !(rowSums(ethnicity[, c("Asian", "Black or African American", "Hispanic or Latino", "Native Hawaiian or Other Pacific Islander", "NA")]) > 0)
ethnicity$"Only White or Asian" <- !(rowSums(ethnicity[, c("Black or African American", "Hispanic or Latino", "Native Hawaiian or Other Pacific Islander", "NA")]) > 0)

View(ethnicity)
```

## Question breakdown

## Results



%--------------------------------------------------------------------
```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.